{% extends 'base.html' %}
{% load static %}
{% load humanize %}
{% block content %}
<br>
<div class="body">
  <br>
  <br><br>
  {% for post_item in post_items %}
  <div class="index_card">
      <div class="index_post_header">
          {% if post_item.user.profile.picture %}
          <a href="{% url 'profile' post_item.user %}"><img src="{{ post_item.user.profile.picture.url }}" alt=""></a>
          {% else %}
          <a href="{% url 'profile' post_item.user %}"><img src="{% static 'img/no_picture.png'%}" alt=""></a>
          {% endif %}
          <div class="index_heading">
              <p class="index_main_heading">{{ post_item.user.username }} <span>{{ post_item.posted | naturaltime }}</span></p>
              {% if post_item.user.profile.first_name %}
              <p class="index_sub_heading">{{ post_item.user.profile.first_name }} {{ post_item.user.profile.last_name }}</p>
              {% endif %}
          </div>

      </div>
      <div class="index_post_img">
          {% if post_item.content.first.file.name|slice:"-3:" == 'jpg' or post_item.content.first.file.name|slice:"-3:" == 'png'  or post_item.content.first.file.name|slice:"-4:" == 'jpeg' %}
          <a href="{{ post_item.get_absolute_url }}"><img src="{{ post_item.content.first.file.url }}" alt="post image"></a>
          {% else %}
          <a href="{{ post_item.get_absolute_url }}">
              <video width="1080" controls="controls" preload="metadata">
                <source src="{{ post_item.content.first.file.url }}#t=0.5" type="video/mp4">
              </video>
          </a> 
          {% endif %}
      </div>
      <div class="index_post_footer">
          <div class="index_left_box">
              <a href="{% url 'postlike' post_item.id %}"><img src="{% static 'img/heart.png'%}" class="heart" alt="" srcset=""></a>
              <a href="{{ post_item.get_absolute_url }}">
                <img src="{% static 'img/comment.png'%}" alt="" srcset="">
              </a>

          </div>
          <div class="index_right_box">
            <a href="{{ post_item.get_absolute_url }}"> 
              <i class="fas fa-ellipsis-v detail"></i></a>
          </div>
      </div>
      <h4 class="index_likes">{{ post_item.likes }} likes</h4>
      <h4 class="index_post"><b>@{{ post_item.user.username }}</b>, {{ post_item.caption }} {% for tag in post_item.tags.all %}<span><a href="{{ tag.get_absolute_url }}">#{{ tag }}</a></span>{% endfor %}</h4>
      
  </div>
  <br> <br>
  {% endfor %}
</div>

{% endblock %}